<%- layout("/layouts/boilerplate") %>
<body>
    <!-- <h1>All Listings</h1> -->
    <!-- <form method ="GET" action ="/listing/New" >
    <button>Create New Listing</button>
    </form>  -->

    <style>
      #filters{
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        justify-content: flex-start;
      }

      .filter{
        text-align: center;
        margin-right: 2rem;
        margin-top: 2rem;
        opacity: 0.7;
      }

      .filter:hover{
        opacity: 1;
        cursor: pointer;
      }

      .filter p{
        font-size: 0.8rem;
      }
      .tax-info{
        display: none;
      }

      .tax-toggle{
        border: 1px solid black;
        border-radius: 1rem;
        height: 3.5rem;
        padding: 1rem;
        margin-left: 1rem;
        display: flex;
        align-items: center;
      }

      .search-results-info {
        margin-top: 1rem;
        margin-bottom: 1rem;
      }

      .no-results {
        text-align: center;
        padding: 3rem 0;
      }

      @media (max-width: 768px) {
        .tax-toggle {
          width: 100%;
          margin-left: 0;
          margin-top: 1rem;
          justify-content: center;
        }
      }

    </style>

    <div class="filters-container">
      <div id="filters">

          <div class="filter">
            <div><i class="fa-solid fa-fire"></i></div>
            <p>Trending</p>
          </div>

          <div class="filter">
            <div><i class="fa-solid fa-bed"></i></div>
            <p>Rooms</p>
          </div>

          <div class="filter">
            <div><i class="fa-solid fa-mountain-city"></i></div>
            <p>Iconic Cities</p>
          </div>

          <div class="filter">
            <div><i class="fa-solid fa-mountain-sun"></i></div>
            <p>Mountains</p>
          </div>

          <div class="filter">
            <div><i class="fa-brands fa-fort-awesome"></i></div>
            <p>Castles</p>
          </div>

          <div class="filter">
            <div><i class="fa-solid fa-person-swimming"></i></div>
            <p>Amazing Pool</p>
          </div>

          <div class="filter">
            <div><i class="fa-solid fa-campground"></i></div>
            <p>Camping</p>
          </div>

          <div class="filter">
            <div><i class="fa-solid fa-tractor"></i></div>
            <p>Farms</p>
          </div>

          <div class="filter">
            <div><i class="fa-solid fa-snowflake"></i></div>
            <p>Arctic</p>
          </div>

          <div class="filter">
            <div><i class="fa-solid fa-children"></i></div>
            <p>Hook up</p>
          </div>

          <div class="filter">
            <div><i class="fa-solid fa-igloo"></i></div>
            <p>Domes</p>
          </div>

          <div class="tax-toggle">
            <div class="form-check-reverse form-switch">
              <input class="form-check-input" type="checkbox" role="switch" id="switchCheckDefault">
              <label class="form-check-label" for="switchCheckDefault">Display total after taxes</label>
            </div>
          </div>

      </div>
    </div>

    <% if(searchQuery) { %>
      <div class="search-results-info">
        <h4>Search results for: "<%= searchQuery %>"</h4>
        <p><%= allListings.length %> <%= allListings.length === 1 ? 'listing' : 'listings' %> found</p>
        <a href="/listings" class="btn btn-sm btn-outline-secondary">Clear search</a>
      </div>
    <% } %>

    <% if(allListings.length === 0) { %>
      <div class="no-results">
        <h3>No listings found</h3>
        <% if(searchQuery) { %>
          <p>No listings match your search for "<%= searchQuery %>"</p>
          <a href="/listings" class="btn btn-primary">View all listings</a>
        <% } else { %>
          <p>There are no listings available at this time.</p>
        <% } %>
      </div>
    <% } else { %>
      <div class="row row-cols-lg-3 row-cols-md-2 row-cols-sm-1 row-cols-1 mt-3">
      <% for(let listing of allListings) { %>
      <a class="listling-link" href="/listings/<%= listing._id%>">   
      <div class="card col listing-card"  >
          <img src="<%= listing.image.url %>" class="card-img-top" style="height: 20rem;" alt="listing_image" >
          <div class="card-img-overlay"></div>
          <div class="card-body">
            <p class="card-text">
              <b><%= listing.title %></b> <br>
              &#8377; <%= listing.price.toLocaleString("en-IN") %> / Night
              <i class="tax-info"> &nbsp; &nbsp;  +18% GST</i>
            </p>
          </div>
      </div>
      </a> 
      <% } %>
      </div>
    <% } %>
</body>

<script>
   let taxSwitch = document.getElementById("switchCheckDefault")
   taxSwitch.addEventListener("click", () => {
      let taxinfo = document.getElementsByClassName("tax-info")
      for(info of taxinfo) {
        if(info.style.display != "inline") {
            info.style.display = "inline"
        }
        else {
          info.style.display = "none"
        }
      }
   })
</script>


